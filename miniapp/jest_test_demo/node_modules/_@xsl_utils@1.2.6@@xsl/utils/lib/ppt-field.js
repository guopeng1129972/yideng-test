'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _ramda = require('ramda');

var _regexp = require('./regexp');

function getFieldUidsAndPatients(formulaArr) {
  var reg = /\$(\d+)\[(\d+)\]/g;
  var mergedArr = (0, _ramda.unnest)(formulaArr.map(function (formula) {
    return (0, _regexp.getAllCaptureGroups)({ str: formula, regExp: reg });
  }));
  if (mergedArr.some(function (v) {
    return v[2] === undefined;
  })) {
    throw new Error('有错误的公式，不可缺少病例序号');
  }
  return {
    fieldIndexes: (0, _ramda.sort)((0, _ramda.ascend)(function (v) {
      return v;
    }), (0, _ramda.uniq)(mergedArr.map(function (v) {
      return +v[1];
    }))),
    patientIndexes: (0, _ramda.sort)((0, _ramda.ascend)(function (v) {
      return v;
    }), (0, _ramda.uniq)(mergedArr.map(function (v) {
      return +v[2];
    })))
  };
}

exports.default = { getFieldUidsAndPatients: getFieldUidsAndPatients };
module.exports = exports['default'];
//# sourceMappingURL=ppt-field.js.map