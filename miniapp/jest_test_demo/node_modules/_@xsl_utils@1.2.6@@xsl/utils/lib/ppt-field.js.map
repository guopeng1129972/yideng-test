{"version":3,"sources":["../src/ppt-field.js"],"names":["getFieldUidsAndPatients","formulaArr","reg","mergedArr","map","str","formula","regExp","some","v","undefined","Error","fieldIndexes","patientIndexes"],"mappings":";;;;;;AAAA;;AACA;;AAEA,SAASA,uBAAT,CAAiCC,UAAjC,EAA6C;AAC3C,MAAMC,MAAM,mBAAZ;AACA,MAAMC,YAAY,mBAAOF,WAAWG,GAAX,CAAe;AAAA,WAAW,iCAAoB,EAAEC,KAAKC,OAAP,EAAgBC,QAAQL,GAAxB,EAApB,CAAX;AAAA,GAAf,CAAP,CAAlB;AACA,MAAIC,UAAUK,IAAV,CAAe;AAAA,WAAKC,EAAE,CAAF,MAASC,SAAd;AAAA,GAAf,CAAJ,EAA6C;AAC3C,UAAM,IAAIC,KAAJ,CAAU,iBAAV,CAAN;AACD;AACD,SAAO;AACLC,kBAAc,iBAAK,mBAAO;AAAA,aAAKH,CAAL;AAAA,KAAP,CAAL,EAAqB,iBAAKN,UAAUC,GAAV,CAAc;AAAA,aAAK,CAACK,EAAE,CAAF,CAAN;AAAA,KAAd,CAAL,CAArB,CADT;AAELI,oBAAgB,iBAAK,mBAAO;AAAA,aAAKJ,CAAL;AAAA,KAAP,CAAL,EAAqB,iBAAKN,UAAUC,GAAV,CAAc;AAAA,aAAK,CAACK,EAAE,CAAF,CAAN;AAAA,KAAd,CAAL,CAArB;AAFX,GAAP;AAID;;kBAEc,EAAET,gDAAF,E","file":"ppt-field.js","sourcesContent":["import { unnest, uniq, sort, ascend } from 'ramda'\nimport { getAllCaptureGroups } from './regexp'\n\nfunction getFieldUidsAndPatients(formulaArr) {\n  const reg = /\\$(\\d+)\\[(\\d+)\\]/g\n  const mergedArr = unnest(formulaArr.map(formula => getAllCaptureGroups({ str: formula, regExp: reg })))\n  if (mergedArr.some(v => v[2] === undefined)) {\n    throw new Error('有错误的公式，不可缺少病例序号')\n  }\n  return {\n    fieldIndexes: sort(ascend(v => v), uniq(mergedArr.map(v => +v[1]))),\n    patientIndexes: sort(ascend(v => v), uniq(mergedArr.map(v => +v[2]))),\n  }\n}\n\nexport default { getFieldUidsAndPatients }\n"]}