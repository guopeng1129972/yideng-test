{"version":3,"sources":["../src/send-sms.js"],"names":["mobile","content","channel","mobileRegex","test","Error","request","post","config","smsApiUrl","send","Number","R","path","JSON","parse"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;;;AAEA;;;;;;;sFAMe;AAAA,QAASA,MAAT,SAASA,MAAT;AAAA,QAAiBC,OAAjB,SAAiBA,OAAjB;AAAA,8BAA0BC,OAA1B;AAAA,QAA0BA,OAA1B,iCAAoC,GAApC;AAAA;AAAA;AAAA;AAAA;AAAA,gBACRC,kBAAYC,IAAZ,CAAiBJ,MAAjB,CADQ;AAAA;AAAA;AAAA;;AAAA,kBACwB,IAAIK,KAAJ,CAAU,WAAV,CADxB;;AAAA;AAAA,gBAERJ,OAFQ;AAAA;AAAA;AAAA;;AAAA,kBAEO,IAAII,KAAJ,CAAU,QAAV,CAFP;;AAAA;AAAA;AAAA;AAAA,mBAILC,qBAAQC,IAAR,CAAaC,iBAAOC,SAApB,EAA+BC,IAA/B,CAAoC;AACxCV,sBAAQW,OAAOX,MAAP,CADgC;AAExCC,8BAFwC;AAGxCC;AAHwC,aAApC,CAJK;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,kBAUL,IAAIG,KAAJ,CAAUO,gBAAEC,IAAF,CAAO,CAAC,KAAD,CAAP,EAAgBC,KAAKC,KAAL,CAAWH,gBAAEC,IAAF,CAAO,CAAC,UAAD,EAAa,MAAb,CAAP,cAAX,CAAhB,KAAkE,MAA5E,CAVK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","file":"send-sms.js","sourcesContent":["import request from 'superagent'\nimport R from 'ramda'\nimport { mobileRegex } from './lang'\nimport config from './config'\n\n/**\n * 通过短信服务发送短息\n *\n * @param mobile 字符串和数字均可\n * @returns 如果发生错误, 会抛出异常, 包含错误信息\n */\nexport default async ({ mobile, content, channel = '0' }) => {\n  if (!mobileRegex.test(mobile)) throw new Error('不是有效的手机号码')\n  if (!content) throw new Error('发送内容为空')\n  try {\n    await request.post(config.smsApiUrl).send({\n      mobile: Number(mobile),\n      content,\n      channel,\n    })\n  } catch (err) {\n    throw new Error(R.path(['msg'])(JSON.parse(R.path(['response', 'text'])(err))) || '未知错误')\n  }\n}\n"]}